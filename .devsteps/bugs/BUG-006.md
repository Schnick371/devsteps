# Hide Done Toggle Not Working in Hierarchical View

## Problem
After switching to hierarchical view, the "Toggle Hide Done" command updates the state but doesn't filter out items with status "done".

**Logs:**
```
13:42:54 - View mode switched to hierarchical ✅
13:43:12 - Hide done toggled: hidden ✅
Result: Items with status "done" still visible ❌
```

## Root Cause
Filter logic only applied in flat view:
- `applyFilters()` called in `getFlatRootNodes()` (line 521) ✅
- `applyFilters()` NOT called in hierarchical view ❌
- `HierarchyRootNode.getChildren()` loads items without filtering
- `WorkItemNode.getChildren()` loads children without filtering

## Solution
Apply `hideDone` filter in hierarchical view at TWO levels:

1. **Top-Level Filtering** (Epics/Requirements):
   - Pass filter state to `HierarchyRootNode`
   - Filter items before creating WorkItemNodes

2. **Child-Level Filtering** (Stories/Tasks/Features):
   - Pass filter state to `WorkItemNode`
   - Filter children in `getChildren()` method

## Implementation Plan

### 1. Update TreeNode base class
Pass `filterState` through node hierarchy:
```typescript
abstract class TreeNode {
  abstract toTreeItem(): vscode.TreeItem;
  abstract getChildren(workspaceRoot: vscode.Uri, filterState?: FilterState): Promise<TreeNode[]>;
}
```

### 2. Update HierarchyRootNode
```typescript
async getChildren(workspaceRoot: vscode.Uri, filterState?: FilterState): Promise<TreeNode[]> {
  // ... load items ...
  
  // Apply hideDone filter
  let filteredItems = items;
  if (filterState?.hideDone) {
    filteredItems = items.filter(item => item.status !== 'done');
  }
  
  return filteredItems.map(item => new WorkItemNode(item, true, filterState));
}
```

### 3. Update WorkItemNode
```typescript
async getChildren(workspaceRoot: vscode.Uri, filterState?: FilterState): Promise<TreeNode[]> {
  // ... load children ...
  
  // Apply hideDone filter
  let filteredChildren = children;
  if (filterState?.hideDone) {
    filteredChildren = children.filter(item => item.status !== 'done');
  }
  
  return filteredChildren.map(item => new WorkItemNode(item, true, filterState));
}
```

### 4. Update getTreeItem() call
```typescript
async getChildren(element?: TreeNode): Promise<TreeNode[]> {
  if (!element) {
    if (this.viewMode === 'flat') {
      return this.getFlatRootNodes();
    }
    return this.getHierarchicalRootNodes();
  }
  
  // Pass filterState to children
  return element.getChildren(this.workspaceRoot, this.filterState);
}
```

## Testing
- [ ] Flat view: hideDone still works
- [ ] Hierarchical view: Top-level items filtered
- [ ] Hierarchical view: Child items filtered
- [ ] Toggle on/off cycles correctly
- [ ] No console errors

## Affected Files
- `packages/vscode-extension/src/treeView/devstepsTreeDataProvider.ts`

## Related
- TASK-031 (originally marked done but incomplete)
- User workflow: devsteps-workflow.prompt.md