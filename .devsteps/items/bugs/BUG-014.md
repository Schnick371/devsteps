# Critical Bug: Incorrect Minimum VS Code Version (1.95.0 → 1.99.0)

## Problem
**INCORRECT MINIMUM VERSION DOCUMENTED** across extension files:

### Current State (WRONG):
```json
// package.json
"engines": {
  "vscode": "^1.95.0"  // ❌ INCORRECT - MCP API doesn't exist in 1.95!
}
```

### Evidence:
**VS Code Release History:**
- **1.95.0**: Oktober 2024 - **NO MCP API**
- **1.99.0**: März 2025 - **MCP API INTRODUCED** (`registerMcpServerDefinitionProvider`)

**Source:** https://code.visualstudio.com/updates/v1_99
> "This release supports Model Context Protocol (MCP) servers in agent mode."

## Root Cause
Extension was developed **after** VS Code 1.99 release, but **minimum version was guessed** (likely copied from another extension or assumed).

## Impact
**CRITICAL USER EXPERIENCE ISSUE:**
- Users with VS Code 1.95-1.98 can **install extension**
- **MCP Server registration FAILS** silently (API doesn't exist)
- Fallback message shown: "Add it to your mcp.json manually"
- Users confused: "Why doesn't auto-registration work?"

**Example Failure Scenario:**
```typescript
// mcpServerManager.ts:34
if (!('lm' in vscode) || !('registerMcpServerDefinitionProvider' in (vscode as any).lm)) {
  // ❌ This code path ALWAYS runs in VS Code < 1.99
  this.showFallbackConfiguration();
  return;
}
```

## Correct Minimum Version

**Minimum: VS Code 1.99.0** (März 2025)

**Why not 1.105?**
- 1.99 introduced `registerMcpServerDefinitionProvider` API
- 1.105 added **enhancements** (MCP marketplace, discovery from Claude Desktop)
- Extension **works** with 1.99 (just missing marketplace features)

## Files to Update

### 1. package.json (engines)
```json
"engines": {
  "vscode": "^1.99.0"  // ✅ CORRECT - MCP API available
}
```

### 2. package.json (devDependencies)
```json
"@types/vscode": "^1.99.0",  // Match engines version
```

### 3. README.md
```markdown
## Requirements
- **VS Code 1.99.0+** (March 2025 or later)
  - Required for Model Context Protocol (MCP) server auto-registration
- `.devsteps/` directory in workspace root
```

### 4. CHANGELOG.md
```markdown
## [0.4.5] - 2025-11-26
### Fixed
- **Minimum VS Code version**: Corrected from 1.95.0 to 1.99.0
  - VS Code 1.99.0 (March 2025) required for MCP API support
  - Previous versions (1.95-1.98) will not work with auto-registration
```

### 5. mcpServerManager.ts (Comment)
```typescript
/**
 * MCP Server Manager - Automatic startup and configuration
 * Uses VS Code's official registerMcpServerDefinitionProvider API
 * 
 * **Requires VS Code 1.99.0+** (March 2025)
 * API introduced in: https://code.visualstudio.com/updates/v1_99
 */
```

## Acceptance Criteria
- [ ] package.json engines updated to `^1.99.0`
- [ ] @types/vscode updated to `^1.99.0`
- [ ] README.md requirements section updated
- [ ] CHANGELOG.md documents correction
- [ ] mcpServerManager.ts comment updated
- [ ] Extension builds successfully
- [ ] Marketplace listing will show correct minimum version

## Testing
1. Check VS Code Marketplace page after publish
2. Verify minimum version shown as "1.99.0"
3. Attempt install in VS Code 1.98 (should be blocked)
4. Confirm install works in VS Code 1.99+

## References
- **VS Code 1.99 Release Notes**: https://code.visualstudio.com/updates/v1_99
- **MCP Documentation**: https://code.visualstudio.com/api/extension-guides/ai/mcp
- **MCP API Finalized**: March 2025 (1.99.0 release)
- **Current Wrong Documentation**: README line 100, CHANGELOG line 53
