# Extension Debug Mode Activation Failure

## Problem
Extension fails to activate in debug mode after STORY-061 added `"type": "module"` to package.json.

**Error:**
```
Activating extension 'devsteps.devsteps' failed: module is not defined in ES module scope
This file is being treated as an ES module because it has a '.js' file extension 
and '/home/th/dev/projekte/playground/devsteps/packages/extension/package.json' 
contains "type": "module". To treat it as a CommonJS script, rename it to use 
the '.cjs' file extension.
```

## Root Cause
- **package.json**: `"type": "module"` (ESM)
- **esbuild output**: `format: 'cjs'` (CommonJS)
- **VS Code**: Tries to load dist/extension.js as ESM but it contains CJS code

## Impact
- Debug mode broken (F5 launch fails)
- Production VSIX unaffected (built Dec 3, before type:module addition)
- Blocks extension development and EPIC-017 testing

## When Introduced
- Commit 773b45a (STORY-061) on December 5, 2025
- Added for TypeScript source files using `.js` import extensions

## Affected Files
- packages/extension/package.json (has "type": "module")
- packages/extension/esbuild.js (outputs format: 'cjs')
- packages/extension/dist/extension.js (CJS code loaded as ESM)

## Solution (RECOMMENDED)
**Option 1: Fix esbuild output to match package.json**
- Change esbuild `format: 'cjs'` â†’ `format: 'esm'`
- Keep `"type": "module"` unchanged
- Preserves STORY-061 TypeScript source conventions
- No risk to untested STORY-061 functionality

**Option 2: Revert type:module (NOT RECOMMENDED)**
- Remove `"type": "module"` from package.json
- Keep esbuild CommonJS output
- Requires changing all `.js` import extensions in source
- High risk to STORY-061 code

## Testing Requirements
- Launch extension in debug mode (F5)
- Verify extension activates successfully
- Test MCP server runtime detection (STORY-061 core feature)
- Verify TreeView loads
- Check no regressions in production VSIX build
